<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Friendship Prompt Card</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* Global Styles */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f0f0; /* Very light background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        .title {
            color: #333333;
            font-weight: 700;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        /* Question Card Styles */
        .card-area {
            min-height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
        }

        .question-card {
            background-color: #ffffff; /* Clean white card */
            color: #333333; /* Dark text */
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); /* Soft shadow */
            width: 100%;
            min-height: 150px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.5s ease-out, opacity 0.5s ease-out; 
            transform: scale(1);
            opacity: 1;
            border: 1px solid #eeeeee; /* subtle border */
        }

        .question-card.exit {
            transform: scale(0.9);
            opacity: 0;
        }

        .question-card p {
            font-size: 1.1rem;
            font-weight: 400;
            line-height: 1.6;
            margin: 0;
        }

        /* Answer Area Styles */
        .answer-area {
            margin-top: 20px;
            text-align: left;
        }
        
        #answer-input {
            width: calc(100% - 20px);
            min-height: 80px;
            padding: 10px;
            border: 1px solid #cccccc;
            border-radius: 8px;
            font-family: inherit;
            resize: vertical;
            font-size: 1rem;
            margin-bottom: 10px;
        }
        
        .action-bar {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        /* Button Styles */
        .button {
            flex: 1;
            background-color: #5c7cfa; /* Main button color (Blue) */
            color: #ffffff;
            border: none;
            padding: 12px 20px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .button.voice-btn {
            background-color: #333333; /* Darker button for microphone */
            flex: 0 0 50px; 
            padding: 12px;
            border-radius: 50%;
        }
        
        .button:hover {
            background-color: #4a6ce0;
        }
        
        .button.voice-btn:hover {
            background-color: #000000;
        }

        .button:active {
            transform: scale(0.98);
        }

        /* Microphone Icon (Linear SVG) */
        .mic-icon-svg {
            width: 20px;
            height: 20px;
            fill: none;
            stroke: white;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .footer {
            margin-top: 25px;
            font-size: 0.85rem;
            color: #888888;
        }
    </style>
</head>
<body>

    <div class="container">
        <div id="card-area" class="card-area">
            </div>

        <div class="answer-area">
            <label for="answer-input" style="font-weight: 700; color: #333333;">Your Answer:</label>
            <textarea id="answer-input" placeholder="Type your answer here..."></textarea>
            
            <div class="action-bar">
                <button id="generate-btn" class="button">Next Question</button>
                
                <button id="voice-btn" class="button voice-btn" title="Voice Input (Requires browser support)">
                    <svg class="mic-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                        <line x1="12" y1="19" x2="12" y2="23"></line>
                        <line x1="8" y1="23" x2="16" y2="23"></line>
                    </svg>
                </button>
            </div>
        </div>
        
        <p class="footer">ðŸ’¡ A prompt to encourage connecting with a faraway friend.</p>
    </div>

    <script>
        // Friendship questions in English
        const questions = [
            "What's the weather like where you are right now? (Remember to bring an umbrella or sunscreen!)",
            "Did anything happen recently that made you laugh out loud? Share the story!",
            "Did you try any new food today? Was it delicious?",
            "How much rest time did you manage to schedule for yourself during your busy day?",
            "If you had one free day, where would you choose to go and what would you do?",
            "Do you have any small, recent accomplishments that are worth celebrating?",
            "When was the last time you felt completely relaxed, and what were you doing?",
            "Have you watched any interesting movies or videos recently? Give me a recommendation!",
            "What sounds are currently dominant in your city? (e.g., wind, traffic, people)",
            "What's one thing we haven't done yet that you'd most like to do together?",
            "If you could swap one skill with me, which one would you choose?",
            "What is one thing you truly wish you had right now, big or small (like a cup of boba)?",
            "What is the biggest difference between your current city and your hometown?"
        ];

        const cardArea = document.getElementById('card-area');
        const generateBtn = document.getElementById('generate-btn');
        const voiceBtn = document.getElementById('voice-btn');
        const answerInput = document.getElementById('answer-input');

        let currentQuestionIndex = -1; 

        /**
         * Selects a random question, ensuring it's different from the current one.
         */
        function getRandomQuestion() {
            let newIndex;
            if (questions.length > 1) {
                do {
                    newIndex = Math.floor(Math.random() * questions.length);
                } while (newIndex === currentQuestionIndex);
            } else {
                newIndex = 0; 
            }
            currentQuestionIndex = newIndex;
            return questions[newIndex];
        }

        /**
         * Generates and displays the new question card.
         */
        function displayNewCard() {
            const questionText = getRandomQuestion();
            
            // 1. Create the new card element
            const newCard = document.createElement('div');
            newCard.classList.add('question-card');
            newCard.innerHTML = `<p>${questionText}</p>`;
            
            // 2. Append the new card
            cardArea.appendChild(newCard);
            
            // 3. Clear the answer box
            answerInput.value = '';
        }

        /**
         * Removes the old card with animation and displays the new card.
         */
        function changeCard() {
            const oldCard = cardArea.querySelector('.question-card');
            
            if (oldCard) {
                // Step 1: Add exit animation class
                oldCard.classList.add('exit');
                
                // Step 2: Wait for animation to finish (0.5s) then remove and display new card
                setTimeout(() => {
                    oldCard.remove();
                    displayNewCard();
                }, 500); 
            } else {
                displayNewCard();
            }
        }

        // --- Web Speech API (Voice Recognition) Implementation ---
        
        function startVoiceRecognition() {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

            if (!SpeechRecognition) {
                alert('Sorry, your browser does not support voice input via this button. Please use the microphone icon on your mobile keyboard instead.');
                return;
            }

            const recognition = new SpeechRecognition();
            // Setting recognition language to English (you can change this to 'zh-CN' if preferred)
            recognition.lang = 'en-US'; 
            recognition.continuous = false; 
            recognition.interimResults = false; 
            
            // Start recognition
            voiceBtn.innerHTML = 'ðŸŽ™ï¸ Listening...';
            voiceBtn.disabled = true;
            recognition.start();

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                // Append the result to the input box
                answerInput.value += transcript; 
            };

            recognition.onspeechend = () => {
                recognition.stop();
                voiceBtn.innerHTML = '<svg class="mic-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>';
                voiceBtn.disabled = false;
            };

            recognition.onerror = (event) => {
                console.error('Voice recognition error:', event.error);
                voiceBtn.innerHTML = '<svg class="mic-icon-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line><line x1="8" y1="23" x2="16" y2="23"></line></svg>';
                voiceBtn.disabled = false;
                alert(`Voice recognition error: ${event.error}. Please check your microphone permissions.`);
            };
        }

        // Event Listeners
        window.onload = function() {
            changeCard();
        };

        generateBtn.addEventListener('click', changeCard);
        voiceBtn.addEventListener('click', startVoiceRecognition);
    </script>
</body>
</html>